# 要件定義書

## はじめに

Nocoris（ノコリス）は、日用品やアイテムの残数を簡単に管理するためのFlutterアプリケーションです。ユーザーが日常的に使用するアイテムの数量を直感的に追跡し、在庫管理を効率化することを目的としています。

## 用語集

- **System**: Nocorisアプリケーション全体
- **Item**: 管理対象となるアイテム（名前、数量、アイコン、作成日時、更新日時を持つ）
- **User**: アプリケーションを使用するエンドユーザー
- **Storage_Service**: ローカルストレージへのデータ永続化を担当するサービス
- **Item_Service**: アイテムのビジネスロジックを管理するサービス
- **Count**: アイテムの現在の数量
- **Icon**: アイテムに設定される絵文字アイコン

## 要件

### 要件 1: アイテム作成機能

**ユーザーストーリー:** ユーザーとして、新しいアイテムを作成したい。そうすることで、管理したいアイテムをシステムに登録できる。

#### 受け入れ基準

1. WHEN ユーザーがアイテム作成画面でアイテム名を入力し保存ボタンを押す THEN THE System SHALL 新しいアイテムを作成しアイテム一覧に追加する
2. WHEN ユーザーがアイテム作成時に絵文字アイコンを選択する THEN THE System SHALL そのアイコンをアイテムに関連付ける
3. WHEN ユーザーがアイテム名を空で保存しようとする THEN THE System SHALL エラーメッセージを表示し作成を防ぐ
4. WHEN ユーザーがアイテム作成時に初期数量を入力する THEN THE System SHALL その数量をアイテムの初期値として設定する
5. WHEN ユーザーがアイテム作成時に数量を入力しない THEN THE System SHALL デフォルト値として0を設定する
6. WHEN アイテムが作成される THEN THE Storage_Service SHALL アイテムデータをローカルストレージに永続化する

### 要件 2: アイテム表示機能

**ユーザーストーリー:** ユーザーとして、登録したアイテムの一覧を確認したい。そうすることで、現在管理しているアイテムとその数量を把握できる。

#### 受け入れ基準

1. WHEN ユーザーがアプリを起動する THEN THE System SHALL 保存されているすべてのアイテムを一覧表示する
2. WHEN アイテムが表示される THEN THE System SHALL アイテム名、現在の数量、設定されたアイコンを表示する
3. WHEN アイテムが存在しない THEN THE System SHALL 適切な空状態メッセージを表示する
4. WHEN アプリが起動される THEN THE Storage_Service SHALL ローカルストレージからアイテムデータを読み込む

### 要件 3: 数量管理機能

**ユーザーストーリー:** ユーザーとして、アイテムの数量を増減させたい。そうすることで、使用や補充に応じて正確な残数を管理できる。

#### 受け入れ基準

1. WHEN ユーザーがアイテムの「+」ボタンを押す THEN THE System SHALL そのアイテムの数量を1増加させる
2. WHEN ユーザーがアイテムの「-」ボタンを押す THEN THE System SHALL そのアイテムの数量を1減少させる
3. WHEN アイテムの数量が0の状態で「-」ボタンを押す THEN THE System SHALL 数量を負の値にしない
4. WHEN アイテムの数量が変更される THEN THE System SHALL 変更を即座にUIに反映する
5. WHEN アイテムの数量が変更される THEN THE Storage_Service SHALL 変更をローカルストレージに永続化する

### 要件 4: アイテム編集機能

**ユーザーストーリー:** ユーザーとして、既存のアイテムの情報を編集したい。そうすることで、アイテム名やアイコンを後から変更できる。

#### 受け入れ基準

1. WHEN ユーザーがアイテムをタップして編集画面を開く THEN THE System SHALL 現在のアイテム情報を編集フォームに表示する
2. WHEN ユーザーがアイテム名を変更し保存する THEN THE System SHALL 変更されたアイテム名を保存し一覧に反映する
3. WHEN ユーザーがアイテムのアイコンを変更し保存する THEN THE System SHALL 変更されたアイコンを保存し一覧に反映する
4. WHEN ユーザーがアイテム名を空にして保存しようとする THEN THE System SHALL エラーメッセージを表示し保存を防ぐ
5. WHEN アイテムが編集される THEN THE Storage_Service SHALL 変更をローカルストレージに永続化する

### 要件 5: アイテム削除機能

**ユーザーストーリー:** ユーザーとして、不要になったアイテムを削除したい。そうすることで、管理するアイテムリストを整理できる。

#### 受け入れ基準

1. WHEN ユーザーがアイテムの削除操作を実行する THEN THE System SHALL 削除確認ダイアログを表示する
2. WHEN ユーザーが削除を確認する THEN THE System SHALL アイテムを一覧から削除する
3. WHEN ユーザーが削除をキャンセルする THEN THE System SHALL アイテムを削除せず現在の状態を維持する
4. WHEN アイテムが削除される THEN THE Storage_Service SHALL ローカルストレージからアイテムデータを削除する

### 要件 6: データ永続化機能

**ユーザーストーリー:** ユーザーとして、アプリを再起動してもデータが保持されていてほしい。そうすることで、継続的にアイテム管理ができる。

#### 受け入れ基準

1. WHEN アイテムデータが変更される THEN THE Storage_Service SHALL 変更を即座にローカルストレージに保存する
2. WHEN アプリが起動される THEN THE Storage_Service SHALL ローカルストレージからすべてのアイテムデータを読み込む
3. WHEN ストレージの読み書きでエラーが発生する THEN THE System SHALL 適切なエラーハンドリングを行いユーザーに通知する
4. THE Storage_Service SHALL shared_preferencesを使用してデータを永続化する

### 要件 7: ユーザーインターフェース機能

**ユーザーストーリー:** ユーザーとして、直感的で使いやすいインターフェースを使いたい。そうすることで、効率的にアイテム管理ができる。

#### 受け入れ基準

1. THE System SHALL システムのダークモード設定に応じて自動的にテーマを切り替える
2. WHEN ユーザーがボタンを押す THEN THE System SHALL 適切な視覚的フィードバックを提供する
3. WHEN 非同期処理が実行される THEN THE System SHALL ローディング状態を適切に表示する
4. WHEN エラーが発生する THEN THE System SHALL ユーザーに分かりやすいエラーメッセージを表示する
5. THE System SHALL iOS/macOSプラットフォームで一貫したユーザーエクスペリエンスを提供する

### 要件 8: 絵文字アイコン選択機能

**ユーザーストーリー:** ユーザーとして、アイテムに視覚的に分かりやすいアイコンを設定したい。そうすることで、アイテムを素早く識別できる。

#### 受け入れ基準

1. WHEN ユーザーがアイコン選択ボタンを押す THEN THE System SHALL 絵文字ピッカーを表示する
2. WHEN ユーザーが絵文字を選択する THEN THE System SHALL 選択された絵文字をアイテムのアイコンとして設定する
3. WHEN アイコンが設定されていない THEN THE System SHALL デフォルトアイコンを表示する
4. THE System SHALL emoji_picker_flutterライブラリを使用して絵文字選択機能を提供する
