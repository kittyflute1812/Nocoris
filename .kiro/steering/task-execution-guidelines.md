---
inclusion: always
---

# タスク実行ガイドライン

Nocorisプロジェクトにおけるタスク実行の標準的なルールとワークフローです。

## タスク実行の基本原則

### 1. 段階的実装
- **チェックポイント制:** 大きな機能は段階的に実装し、各段階で動作確認
- **テスト先行:** 実装前にテストケースを明確化
- **漸進的改善:** 最小限の動作する実装から始めて段階的に改善

### 2. 品質保証
- **テスト必須:** すべての実装にはテストを含める
- **診断チェック:** 実装後は必ず`getDiagnostics`でエラーチェック
- **動作確認:** 実装後は実際にアプリを起動して動作確認

### 3. コミット戦略
- **機能単位:** 1つのタスクまたは関連するサブタスクごとにコミット
- **Conventional Commits:** `feat:`, `fix:`, `test:`, `refactor:` などのプレフィックス使用
- **日本語OK:** コミットメッセージは日本語で自然な表現を使用

## タスク実行ワークフロー

### Phase 1: 準備
1. **要件確認:** タスクの要件と期待される成果物を明確化
2. **設計確認:** 既存のアーキテクチャとの整合性を確認
3. **テスト計画:** 実装するテストケースを事前に計画

### Phase 2: 実装
1. **テスト作成:** 実装前にテストケースを作成（TDD推奨）
2. **最小実装:** 最小限の動作する実装を作成
3. **診断確認:** `getDiagnostics`でコンパイルエラーや警告をチェック
4. **テスト実行:** `flutter test`でテストが通ることを確認

### Phase 3: 検証
1. **動作確認:** `flutter run`で実際の動作を確認
2. **品質チェック:** `flutter analyze`でコード品質を確認
3. **パフォーマンス:** 必要に応じてパフォーマンステスト

### Phase 4: 完了
1. **コミット:** Conventional Commits形式でコミット
2. **ドキュメント更新:** 必要に応じてREADMEやコメントを更新
3. **次タスク準備:** 依存関係のあるタスクの準備

## エラーハンドリング

### コンパイルエラー
- `getDiagnostics`で詳細を確認
- エラーメッセージに基づいて修正
- 修正後は再度診断実行

### テスト失敗
- 失敗したテストの詳細を確認
- 実装とテストの両方を見直し
- 必要に応じてテストケースを調整

### 実行時エラー
- Flutter DevToolsでデバッグ
- ログ出力で問題箇所を特定
- エラーハンドリングの追加

## プロパティテストの扱い

### 実行タイミング
- 基本実装完了後に実行
- MVPでは省略可能（`*`マーク付きタスク）
- 本格運用前には必須

### 失敗時の対応
1. プロパティの前提条件を確認
2. 実装のロジックを見直し
3. 必要に応じてプロパティ定義を調整

## チェックポイントでの確認事項

### コアロジック検証時
- [ ] すべての単体テストが通過
- [ ] 基本的なCRUD操作が動作
- [ ] データの整合性が保たれている

### 統合検証時
- [ ] UI操作が正常に動作
- [ ] データの永続化が機能
- [ ] エラーハンドリングが適切

### 最終検証時
- [ ] 全機能が要件を満たしている
- [ ] パフォーマンスが許容範囲
- [ ] ユーザビリティが良好

## 効率化のコツ

### 開発速度向上
- **ホットリロード活用:** UI変更は`r`キーでホットリロード
- **テスト並行実行:** `flutter test --concurrency=4`で高速化
- **部分テスト:** 特定ファイルのみテスト実行

### 品質維持
- **定期的な診断:** 実装中も定期的に`getDiagnostics`実行
- **小さなコミット:** 問題発生時の切り戻しを容易にする
- **ペアプログラミング:** 複雑な実装時はKiroと対話しながら進める

このガイドラインに従って、効率的で高品質なタスク実行を行いましょう。
